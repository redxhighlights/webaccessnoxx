<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Remote PC Control</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>üñ•Ô∏è Remote PC Control</h1>

  <p id="status" style="font-weight: bold; font-size: 18px;">Status: Checking...</p>

  <div>
    <button onclick="sendCommand('shutdown')">üîå Shutdown PC</button>
    <button onclick="sendCommand('screenshot')">üì∏ Take Screenshot</button>
  </div>

  <div>
    <input type="text" id="popupMsg" placeholder="‚ö†Ô∏è Enter warning message">
    <button onclick="sendPopup()">üö® Send Warning</button>
  </div>

  <h2>üñºÔ∏è Live Screenshot</h2>
  <img src="/get_screenshot" width="600" id="screen" alt="Live Screen" />

  <script>
    // Auto-refresh screenshot
    setInterval(() => {
      document.getElementById("screen").src = '/get_screenshot?cache=' + new Date().getTime();
    }, 5000);

    // Check online status
    function checkStatus() {
      fetch('/status')
        .then(res => res.json())
        .then(data => {
          const el = document.getElementById("status");
          if (data.status === "online") {
            el.textContent = "Status: ‚úÖ Online";
            el.style.color = "lime";
          } else {
            el.textContent = "Status: ‚ùå Offline";
            el.style.color = "red";
          }
        });
    }

    setInterval(checkStatus, 5000);
    checkStatus();

    // Send shutdown/screenshot command
    function sendCommand(type) {
      fetch('/add_command?pass=@REDXPRIME', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: type })
      });
    }

    // Send popup warning
    function sendPopup() {
      const msg = document.getElementById("popupMsg").value;
      if (!msg) {
        alert("‚ö†Ô∏è Please enter a message.");
        return;
      }
      fetch('/add_command?pass=@REDXPRIME', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ action: 'popup', message: msg })
      });
      document.getElementById("popupMsg").value = "";
    }
  </script>
</body>
</html>
